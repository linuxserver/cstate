<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Most images using our alpine-nginx base image are being updated to alpine 3.15 with php8 and some significant changes to the nginx configs.
Changes you will likely notice:
Bring our default shipped configs as close as possible to alpine upstream defaults https://git.alpinelinux.org/aports/tree/main/nginx/nginx.conf?h=3.15-stable Include worker_processes.conf and init script to generate it in the base Include resolver.conf and init script to generate it in the base Include ssl.conf in the base (the same as what is currently shipped in SWAG, but adjusted to use the self-signed certs generated by the base) include /config/nginx/site-confs/*."><title>Notification: Significant changes to nginx based images | Info :: LinuxServer.io</title><link rel=canonical href=https://info.linuxserver.io/issues/2022-08-20-nginx-base/><link rel=alternate type=application/json href=https://info.linuxserver.io/issues/2022-08-20-nginx-base/index.json title="Info :: LinuxServer.io"><meta name=generator content="cState v5.6.1 - https://github.com/cstate/cstate"><meta name=theme-color content="#0a0c0f"><script>var themeBrandColor='#0a0c0f',themeOkColor='#008000',themeNoticeColor='#24478f',themeDisruptedColor='#cc4400',themeDownColor='#e60000'</script><style>html,body{margin:0;background:#fff;color:#4d4d4d;font:100%/1.5 inter,inter ui,BlinkMacSystemFont,-apple-system,san francisco text,roboto,segoe ui,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,.25)}::selection{background:#b4d5ff}*,*:before,*:after{box-sizing:inherit}a{text-decoration:none;color:#000;border-bottom:1px dotted}a:hover{border-bottom-style:solid}a:active{position:relative;top:2px}hr{border:0;border-bottom:1px solid #ccc;margin:24px 0}h1{font-size:40px;line-height:1}h2{font-size:26px}h3{font-size:20px}h4{font-size:18px}h1,h2,h4{font-weight:400;color:#000;font-family:inter,inter ui,segoe ui,BlinkMacSystemFont,-apple-system,san francisco display,roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol;letter-spacing:-.4px;overflow-wrap:break-word}h3{margin:0;color:#000}img{border:0;width:100%;height:auto}.hidden{display:none}a.no-underline{border-bottom:0}.headline{font-size:20px}.bold{color:#000}.hinted{color:#6d6d6d}.faded{color:#6d6d6d}.clean{margin:0}.ok{color:green}.warning{color:#c40}.error{color:#e60000}.contain{max-width:640px;margin:16px auto;padding:16px}.markdown pre{overflow-x:scroll}.contain--more{max-width:680px}.center{text-align:center}.right{text-align:right}.padding-s{padding:6px}.padding{padding:12px}.clicky{cursor:pointer}.link-style{border:none}.span-icon{float:right;margin-left:16px}.js .category--open .category__closed-marker{display:none}.js .category--closed .components{display:none}.js .category--closed .category__open-marker{display:none}.js .hidden-with-js{display:none}.hide-without-js{display:none}.js span.hide-without-js{display:inline}.js div.hide-without-js{display:block}.date{display:block;margin-top:12px;color:#666;font-variant:small-caps}.tag{display:inline-block;padding:4px 8px;margin-right:4px;margin-bottom:2px;background:#eee}.tag:hover{background:#ddd}.header{padding:8px 0;background:#0a0c0f}.header a{color:#fff;font-size:14px;font-variant:small-caps}.header a h1{color:#fff}.header__logo img{height:auto;width:320px}.header__logo--small img{height:auto;width:160px}.header--large{padding:16px}.header--large a{font-size:20px}.footer{padding:10px;background:#f5f5f5}.footer__copyright{display:block;font-variant:small-caps}.footer__copyright a,a.header__logo{border-bottom:0}.summary{padding:16px;color:#fff}.summary__date:hover{color:#ccc}.summary__date:hover:after{content:' ⟳ ';color:#fff}.components{border:2px solid #ddd;border-bottom:0}.component{color:#000;padding:16px;border-bottom:2px solid #ddd}.tooltip{cursor:pointer;position:relative}.tooltip__text{display:none}.tooltip:hover .tooltip__text,.tooltip:active .tooltip__text{display:block;position:absolute;top:0;left:24px;background:#181818;color:#fff;z-index:50;padding:8px;border:2px solid #242424;font-size:14px;color:#ccc;width:320px;height:auto}@media(max-width:640px){.tooltip:hover .tooltip__text,.tooltip:active .tooltip__text{width:50vw}}.tabs{border-bottom:1px solid #ccc}.tabs--inner{padding:0 16px;margin:0 auto}a.tab{display:inline-table}.tab--current{border:1px solid #ccc;border-bottom-color:#fff;padding:12px 18px;position:relative;top:1px}.tab--other{border:0;padding:12px 18px;position:relative;top:1px;color:#757575}.tab--other:hover{color:#000}.issue{display:block;padding:14px 24px}.issue:hover,.category__head:hover{background:#f5f5f5}.issue:active,.category__head:active{background:#eee}.issue h3{line-height:1.25}.category__head{margin-top:20px}.archive__head{padding:20px;background:#f5f5f5}.status-ok .summary{background:green}.status-disrupted .summary,.change-header-color.status-disrupted .header{background:#c40}.status-down .summary,.change-header-color.status-down .header{background:#e60000}.status-notice .summary,.change-header-color.status-notice .header{background:#24478f}.announcement-box .padding{padding:16px}.status-disrupted .announcement-box{border:2px solid #c40}.status-down .announcement-box{border:2px solid #e60000}.status-notice .announcement-box{border:2px solid #24478f}.status-disrupted .announcement-box,.status-down .announcement-box,.status-notice .announcement-box{border-top:0}.category--open .category-status{display:none}.component-status,.category-status{float:right}.component[data-status=ok] .component-status,.category__head[data-status=ok] .category-status{color:green}.component[data-status=disrupted] .component-status,.category__head[data-status=disrupted] .category-status{color:#c40}.component[data-status=notice] .component-status,.category__head[data-status=notice] .category-status{color:#24478f}.component[data-status=down] .component-status,.category__head[data-status=down] .category-status{color:#e60000}@media(min-width:640px){.float-right{float:right;display:inline}}@media(prefers-color-scheme:dark){html,body{background:#181a1b;color:#ccc9c1}h1,h2,h3,h4,a,.bold{color:#fafafa}hr{border-bottom-color:#3d3d3d}.footer{background:#1b1d1e}.components{border:2px solid #ddd;border-bottom:0;border-color:#3a3a3a}.component{border-bottom:2px solid #ddd;color:#e8e6e3;border-bottom-color:#3a3a3a}.tabs{border-bottom-color:#3d3d3d}.tab--current{border-color:#3d3d3d;border-bottom-color:#181a1b}.tab--other{color:#757575}.tab--other:hover{color:#fff}.date{color:#c3bfb6}.tag,.archive__head{background-color:#1d1f20}.tag:hover{background:#222}.issue:hover,.category__head:hover{background-color:#212121}.hinted,.faded{color:#c1bcb3}.error{color:#ff4242}.warning{color:#ffde7f}.ok{color:#7fff7f}.component[data-status=ok] .component-status,.category__head[data-status=ok] .category-status{color:#7fff7f}.component[data-status=disrupted] .component-status,.category__head[data-status=disrupted] .category-status{color:#ffde7f}.component[data-status=notice] .component-status,.category__head[data-status=notice] .category-status{color:#83a4e8}.component[data-status=down] .component-status,.category__head[data-status=down] .category-status{color:#ff8181}}</style><style>.pre-header-links{background-color:#0a0c0f;text-align:right;padding-right:10px}.pre-header-links a{border-bottom:none;color:#fff}</style><meta property="og:url" content="https://info.linuxserver.io/issues/2022-08-20-nginx-base/"><meta property="og:type" content="website"><meta property="og:title" content="Notification: Significant changes to nginx based images | Info :: LinuxServer.io"><meta property="og:description" content="Most images using our alpine-nginx base image are being updated to alpine 3.15 with php8 and some significant changes to the nginx configs.
Changes you will likely notice:
Bring our default shipped configs as close as possible to alpine upstream defaults https://git.alpinelinux.org/aports/tree/main/nginx/nginx.conf?h=3.15-stable Include worker_processes.conf and init script to generate it in the base Include resolver.conf and init script to generate it in the base Include ssl.conf in the base (the same as what is currently shipped in SWAG, but adjusted to use the self-signed certs generated by the base) include /config/nginx/site-confs/*."><meta property="og:image" content="https://info.linuxserver.io/logo.png"><meta name=twitter:card content="summary_large_image"><meta property="twitter:domain" content="info.linuxserver.io"><meta property="twitter:url" content="https://info.linuxserver.io/issues/2022-08-20-nginx-base/"><meta name=twitter:title content="Notification: Significant changes to nginx based images | Info :: LinuxServer.io"><meta name=twitter:description content="Most images using our alpine-nginx base image are being updated to alpine 3.15 with php8 and some significant changes to the nginx configs.
Changes you will likely notice:
Bring our default shipped configs as close as possible to alpine upstream defaults https://git.alpinelinux.org/aports/tree/main/nginx/nginx.conf?h=3.15-stable Include worker_processes.conf and init script to generate it in the base Include resolver.conf and init script to generate it in the base Include ssl.conf in the base (the same as what is currently shipped in SWAG, but adjusted to use the self-signed certs generated by the base) include /config/nginx/site-confs/*."><meta name=twitter:image content="https://info.linuxserver.io/logo.png"></head><body class="issues single"><div class=contain><a href=https://info.linuxserver.io>← Go back to <em>Info :: LinuxServer.io</em></a></div><div class=contain><div class=article><h1 class=clean>Notification: Significant changes to nginx based images</h1><small class=date>August 20, 2022 at 6:00 PM</small><p><small><a href=/affected/notifications/ class="tag no-underline">Notifications</a>
<a href=/affected/bookstack/ class="tag no-underline">bookstack</a>
<a href=/affected/cops/ class="tag no-underline">cops</a>
<a href=/affected/diskover/ class="tag no-underline">diskover</a>
<a href=/affected/dokuwiki/ class="tag no-underline">dokuwiki</a>
<a href=/affected/freshrss/ class="tag no-underline">freshrss</a>
<a href=/affected/grav/ class="tag no-underline">grav</a>
<a href=/affected/grocy/ class="tag no-underline">grocy</a>
<a href=/affected/heimdall/ class="tag no-underline">heimdall</a>
<a href=/affected/librespeed/ class="tag no-underline">librespeed</a>
<a href=/affected/lychee/ class="tag no-underline">lychee</a>
<a href=/affected/muximux/ class="tag no-underline">muximux</a>
<a href=/affected/nextcloud/ class="tag no-underline">nextcloud</a>
<a href=/affected/nginx/ class="tag no-underline">nginx</a>
<a href=/affected/photoshow/ class="tag no-underline">photoshow</a>
<a href=/affected/phpmyadmin/ class="tag no-underline">phpmyadmin</a>
<a href=/affected/piwigo/ class="tag no-underline">piwigo</a>
<a href=/affected/pixapop/ class="tag no-underline">pixapop</a>
<a href=/affected/projectsend/ class="tag no-underline">projectsend</a>
<a href=/affected/snapdrop/ class="tag no-underline">snapdrop</a>
<a href=/affected/snipe-it/ class="tag no-underline">snipe-it</a>
<a href=/affected/swag/ class="tag no-underline">swag</a>
<a href=/affected/xbackbone/ class="tag no-underline">xbackbone</a></small></p><hr><div class=markdown><p>Most images using our alpine-nginx base image are being updated to alpine 3.15 with php8 and some significant changes to the nginx configs.</p><p>Changes you will likely notice:</p><ul><li>Bring our default shipped configs as close as possible to alpine upstream defaults<ul><li><a href="https://git.alpinelinux.org/aports/tree/main/nginx/nginx.conf?h=3.15-stable">https://git.alpinelinux.org/aports/tree/main/nginx/nginx.conf?h=3.15-stable</a></li></ul></li><li>Include <code>worker_processes.conf</code> and init script to generate it in the base</li><li>Include <code>resolver.conf</code> and init script to generate it in the base</li><li>Include <code>ssl.conf</code> in the base (the same as what is currently shipped in SWAG, but adjusted to use the self-signed certs generated by the base)</li><li><code>include /config/nginx/site-confs/*.conf;</code> with <code>*.conf</code> extension (rename existing user files automatically)</li><li>Rework <code>default.conf</code><ul><li>Expect applications inside containers to exist at <code>/app/www/public/</code>, and if that does not exist, use <code>/config/www</code></li><li>Include ipv6 support</li><li>deny access to <code>.htaccess</code>/<code>.htpasswd</code> files</li><li>adjust php location and <code>fastcgi_params</code> to use <code>PATH_INFO</code> and mitigate <code>HTTP_PROXY</code> vulnerability</li></ul></li><li>Restructure nginx configs<ul><li>Configs in <code>/defaults/nginx/</code> are recursively copied to the user&rsquo;s <code>/config/nginx/</code> (maintaining the structure)</li><li>All configs are now named <code>*.sample</code> and all include <code>## Version YYYY/MM/DD - Changelog: &lt;url to repo history></code> used by <code>/etc/cont-init.d/85-version-checks</code><ul><li>Required configs (<code>/config/nginx/nginx.conf</code>, <code>/config/nginx/server-confs/ssl.conf</code> and <code>/config/nginx/site-confs/default.conf</code>) are enabled by default. Downstream images can include and/or enable others as needed (ex: SWAG will enable <code>/config/nginx/location-confs/proxy.conf</code> and <code>/config/nginx/server-confs/502.conf</code>)</li></ul></li><li>Folder structure is as follows (in the <code>/config/nginx/</code> context):<ul><li>All nginx based images:<ul><li>Includes <code>nginx.conf</code> (enabled by default)</li><li>Includes <code>resolver.conf</code> (enabled by default)</li><li>Includes <code>ssl.conf</code> (enabled by default)</li><li>Includes <code>worker_processes.conf</code> (enabled by default)</li><li><code>/config/nginx/site-confs/*</code> included inside the <code>http</code> context in <code>/config/nginx/nginx.conf</code><ul><li>Includes <code>default.conf</code> (enabled by default)</li></ul></li></ul></li><li>SWAG:<ul><li>Includes <code>502.conf</code> (enabled by default)</li><li>Includes <code>authelia-location.conf</code></li><li>Includes <code>authelia-server.conf</code></li><li>Includes <code>ldap-location.conf</code></li><li>Includes <code>ldap-server.conf</code></li><li>Includes <code>proxy.conf</code> (enabled by default)</li></ul></li></ul></li></ul></li></ul><p>Under the hood:</p><ul><li>Split out init scripts<ul><li><code>root/migrations/01-nginx-site-confs-default</code> migrate existing <code>default</code> to <code>default.conf</code></li><li><code>root/etc/cont-init.d/11-folders</code> creates all the folders needed in <code>/config</code></li><li><code>root/etc/cont-init.d/12-samples</code> removes existing <code>*.sample</code> files from <code>/config/nginx</code> and copies any included <code>*.sample</code> files from the image</li><li><code>root/etc/cont-init.d/13-nginx</code> enable required configs (<code>nginx.conf</code>, <code>ssl.conf</code> and <code>default.conf</code>) if they don&rsquo;t exist, setup <code>dhparams.pem</code>, setup <code>resolver.conf</code>, setup <code>worker_processes.conf</code></li><li><code>root/etc/cont-init.d/14-php</code> configure php</li><li><code>root/etc/cont-init.d/15-keygen</code> create self signed certificates for <code>ssl.conf</code></li><li><code>root/etc/cont-init.d/20-permissions</code> set <code>/config</code> permissions</li><li><code>root/etc/cont-init.d/85-version-checks</code> check all enabled <code>*.conf</code> files against all <code>*.sample</code> files shipped with the image and alert the user about updates</li></ul></li></ul><p>Status of affected images:</p><table><thead><tr><th>Image</th><th>Branch</th><th>PR</th><th>Notes</th></tr></thead><tbody><tr><td>baseimage-alpine-nginx</td><td>master</td><td><a href=https://github.com/linuxserver/docker-baseimage-alpine-nginx/pull/84>https://github.com/linuxserver/docker-baseimage-alpine-nginx/pull/84</a></td><td></td></tr><tr><td>bookstack</td><td>master</td><td><a href=https://github.com/linuxserver/docker-bookstack/pull/113>https://github.com/linuxserver/docker-bookstack/pull/113</a></td><td></td></tr><tr><td>cops</td><td>master</td><td><a href=https://github.com/linuxserver/docker-cops/pull/34>https://github.com/linuxserver/docker-cops/pull/34</a></td><td>composer downgraded to v1 for compatibility</td></tr><tr><td>diskover</td><td>master</td><td><a href=https://github.com/linuxserver/docker-diskover/pull/43>https://github.com/linuxserver/docker-diskover/pull/43</a></td><td></td></tr><tr><td>dokuwiki</td><td>master</td><td><a href=https://github.com/linuxserver/docker-dokuwiki/pull/43>https://github.com/linuxserver/docker-dokuwiki/pull/43</a></td><td></td></tr><tr><td>freshrss</td><td>master</td><td><a href=https://github.com/linuxserver/docker-freshrss/pull/40>https://github.com/linuxserver/docker-freshrss/pull/40</a></td><td></td></tr><tr><td>grav</td><td>main</td><td><a href=https://github.com/linuxserver/docker-grav/pull/9>https://github.com/linuxserver/docker-grav/pull/9</a></td><td></td></tr><tr><td>grocy</td><td>master</td><td><a href=https://github.com/linuxserver/docker-grocy/pull/52>https://github.com/linuxserver/docker-grocy/pull/52</a></td><td></td></tr><tr><td>heimdall</td><td>main</td><td><a href=https://github.com/linuxserver/docker-heimdall/pull/79>https://github.com/linuxserver/docker-heimdall/pull/79</a></td><td></td></tr><tr><td>librespeed</td><td>master</td><td><a href=https://github.com/linuxserver/docker-librespeed/pull/15>https://github.com/linuxserver/docker-librespeed/pull/15</a></td><td></td></tr><tr><td>lychee</td><td>master</td><td><a href=https://github.com/linuxserver/docker-lychee/pull/51>https://github.com/linuxserver/docker-lychee/pull/51</a></td><td></td></tr><tr><td>muximux</td><td>master</td><td><a href=https://github.com/linuxserver/docker-muximux/pull/26>https://github.com/linuxserver/docker-muximux/pull/26</a></td><td></td></tr><tr><td>nextcloud</td><td>master</td><td><a href=https://github.com/linuxserver/docker-nextcloud/pull/219>https://github.com/linuxserver/docker-nextcloud/pull/219</a></td><td></td></tr><tr><td>nginx</td><td>master</td><td><a href=https://github.com/linuxserver/docker-nginx/pull/79>https://github.com/linuxserver/docker-nginx/pull/79</a></td><td></td></tr><tr><td>photoshow</td><td>master</td><td><a href=https://github.com/linuxserver/docker-photoshow/pull/28>https://github.com/linuxserver/docker-photoshow/pull/28</a></td><td><a href=https://info.linuxserver.io/issues/2022-10-14-photoshow/>Deprecated</a></td></tr><tr><td>phpmyadmin</td><td>main</td><td><a href=https://github.com/linuxserver/docker-phpmyadmin/pull/12>https://github.com/linuxserver/docker-phpmyadmin/pull/12</a></td><td></td></tr><tr><td>piwigo</td><td>master</td><td><a href=https://github.com/linuxserver/docker-piwigo/pull/49>https://github.com/linuxserver/docker-piwigo/pull/49</a></td><td></td></tr><tr><td>pixapop</td><td>master</td><td><a href=https://github.com/linuxserver/docker-pixapop/pull/11>https://github.com/linuxserver/docker-pixapop/pull/11</a></td><td><a href=https://info.linuxserver.io/issues/2022-10-14-pixapop>Deprecated</a></td></tr><tr><td>projectsend</td><td>master</td><td><a href=https://github.com/linuxserver/docker-projectsend/pull/22>https://github.com/linuxserver/docker-projectsend/pull/22</a></td><td></td></tr><tr><td>snapdrop</td><td>master</td><td><a href=https://github.com/linuxserver/docker-snapdrop/pull/6>https://github.com/linuxserver/docker-snapdrop/pull/6</a></td><td></td></tr><tr><td>snipe-it</td><td>master</td><td><a href=https://github.com/linuxserver/docker-snipe-it/pull/28>https://github.com/linuxserver/docker-snipe-it/pull/28</a></td><td></td></tr><tr><td>swag</td><td>master</td><td><a href=https://github.com/linuxserver/docker-swag/pull/169>https://github.com/linuxserver/docker-swag/pull/169</a></td><td></td></tr><tr><td>xbackbone</td><td>main</td><td><a href=https://github.com/linuxserver/docker-xbackbone/pull/5>https://github.com/linuxserver/docker-xbackbone/pull/5</a></td><td></td></tr></tbody></table><p>Any images with notes above may not be merged. We will make efforts to update this page if any of the images with notes above are merged at a later date. We may also make individual announcements about status updates regarding these images.</p></div></div><div class=padding></div></div><div class="contain center"><p>Last updated:
October 14, 2022 at 9:13 AM</p></div><script type=text/javascript>console.log('cState v5.6.1 - https://github.com/cstate/cstate'),document.getElementsByTagName('html')[0].className='js',document.body.className==='change-header-color'&&(document.body.className==='status-down'?document.querySelector('meta[name=theme-color]').setAttribute('content',themeDownColor):document.body.className==='status-disrupted'?document.querySelector('meta[name=theme-color]').setAttribute('content',themeDisruptedColor):document.querySelector('meta[name=theme-color]').setAttribute('content',themeNoticeColor)),window.location.hash.match('access_token')&&(document.location.pathname='/admin'),window.location.hash.match('invite_token')&&(document.location.pathname='/admin'),window.location.hash.match('confirmation_token')&&(document.location.pathname='/admin'),window.location.hash.match('email_change_token')&&(document.location.pathname='/admin'),window.location.hash.match('recovery_token')&&(document.location.pathname='/admin');function toggleCategoryHead(e){e.parentNode.className=='category category--open category--titled'?e.parentNode.className='category category--closed category--titled':e.parentNode.className='category category--open category--titled'}function timeSince(n){var t=Math.floor((new Date-n)/1e3),e=Math.floor(t/31536e3);return e>1?e+' years':(e=Math.floor(t/2592e3),e>1?e+' months':(e=Math.floor(t/86400),e>1?e+'d':(e=Math.floor(t/3600),e>1?e+'h':(e=Math.floor(t/60),e>1?e+' min':Math.floor(t)<0?Math.floor(t):Math.floor(t)+'s'))))}function updateRelativeTimes(){for(var e,t,n,o=document.querySelectorAll('.relative-time'),s=0;s<o.length;s++)e=o[s],t=Date.parse(e.dataset.date),n=e.getAttribute('data-time-prefix')||'',t?timeSince(t)<0?n=e.innerText:n+=timeSince(t)+' ago':(t=e.innerText,e.setAttribute('title',t||new Date),n+='just now'),n+=e.getAttribute('data-time-suffix')||'',e.innerHTML=n.trim()}updateRelativeTimes(),setInterval(updateRelativeTimes,5e3)</script><div class=footer><div class=contain><p><strong class=bold>&copy; Info :: LinuxServer.io, 2024</strong>
&nbsp; • &nbsp; <a href=#>Back to top</a></p><p>LinuxServer.io Status page</p><small class="footer__copyright faded">Powered by <a href=https://github.com/cstate/cstate><b>cState</b></a></small><hr><p class=hinted><small>⚡
Subscribe via RSS —
<a href=https://info.linuxserver.io/index.xml class=no-underline>to all updates</a></small></p></div></div></body></html>